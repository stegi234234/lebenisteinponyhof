<script setup>
import { ref } from 'vue';
import { useMySeoMeta } from '~/composables/useMySeoMeta'; // HINZUGEFÃœGT
import { NuxtLink } from '#components';
import { useRuntimeConfig, useRoute } from '#app'; // HINZUGEFÃœGT fÃ¼r siteUrl und businessAddress

const config = useRuntimeConfig();
const route = useRoute(); // HINZUGEFÃœGT fÃ¼r canonicalUrl
const siteUrl = config.public.siteUrl;
const businessAddress = config.public.businessAddress;

/*--------------------------------------------------
| Kopfâ€‘ und SEOâ€‘Daten
--------------------------------------------------*/
const baseFaqs = [
  // ... (deine baseFaqs bleiben unverÃ¤ndert) ...
  {
    q: 'Ab welchem Alter kÃ¶nnen Kinder bei euch reiten?',
    a: "Mit ca. 3 Jahren geht's los - dann sind die Kleinen gerade groÃŸ genug, um nicht vom Pony zu purzeln (und wir mÃ¼ssen nicht permanent in RÃ¼ckenhaltung mitlaufen), obwohl da das Mitkommen eines Erwachsenen vorausgesetzt wird. Unsere Ferienkurse sind fÃ¼r Abenteurer von 6â€“12 Jahren perfekt. FÃ¼r unsere therapeutischen Einheiten gibt's keine starre Altersgrenze â€“ da schauen wir individuell, was passt. Und Kindergeburtstage? Die feiern wir am liebsten mit 4- bis 10-JÃ¤hrigen, weil da der Wunsch nach Ponys und Glitzer noch grÃ¶ÃŸer ist als der nach dem neuesten Smartphone.",
  },
  {
    q: 'Muss mein Kind schon reiten kÃ¶nnen?',
    a: 'Ãœberhaupt nicht! Wir starten genau da, wo dein Kind steht. Keine Ahnung von Pferden? Kein Problem! Unsere geduldigen Ponys (und wir) zeigen alles, was wichtig ist. Es geht uns vor allem um die Begegnung mit dem Tier, SpaÃŸ und FÃ¶rderung â€“ nicht um perfekte Dressur. Zugegeben, manchmal zeigen uns die Ponys auch, dass <i>sie</i> die wahren Chefs sind â€“ aber genau diese Momente sind oft die lehrreichsten!',
  },
  {
    q: 'Was soll mein Kind anziehen? Brauchen wir spezielle AusrÃ¼stung?',
    a: 'Dresscode: "Darf dreckig werden!" ğŸ˜‰ Wichtig sind feste, geschlossene Schuhe (bitte keine Sandalen oder Crocs - Pferdehuf trifft Zeh ist kein SpaÃŸ). Eine lange Hose schÃ¼tzt die Beine beim Reiten (Jeans, Leggings oder Jogginghose sind super). Ein Helm ist Pflicht â€“ wir haben Leihhelme, aber falls ein eigener Reit- oder Fahrradhelm vorhanden ist, bringt den gerne mit. Ansonsten braucht ihr keine SpezialausrÃ¼stung â€“ keine Sorge, wir sind kein Nobel-Reitstall mit Dresscode!',
  },
  {
    q: 'Was ist, wenn es regnet? Fallen dann alle PlÃ¤ne ins Wasser?',
    a: 'NÃ¶! Wir sind doch nicht aus Zucker (und die Ponys auch nicht). Wir haben einen Ã¼berdachten Putzplatz und gemÃ¼tliche Bereiche im Stall, wo wir auch bei Regen viele AktivitÃ¤ten durchfÃ¼hren kÃ¶nnen. Bei leichtem Nieselregen reiten wir trotzdem - mit der richtigen Kleidung ist das kein Problem. Nur bei Weltuntergangswetter (Sturm, Gewitter oder sintflutartigem Regen) mÃ¼ssen wir das Programm anpassen â€“ Sicherheit geht vor. Dann machen wir einfach mehr Bodenarbeit, Theorie oder Stallkunde. Spannend ist es immer!',
  },
  {
    q: 'Wie melde ich mein Kind an oder buche einen Termin?',
    a: 'Am besten Ã¼ber unser <NuxtLink to="/contact" class="text-primary-color hover:underline font-semibold">Kontaktformular</NuxtLink>, per E-Mail oder Telefon. Wir sind zwar viel im Stall unterwegs, melden uns aber so schnell wie mÃ¶glich zurÃ¼ck! Wir klÃ¤ren dann gemeinsam alle Details und senden bei Bedarf ein Anmeldeformular. Kleiner Tipp: Besonders fÃ¼r Kindergeburtstage und Ferienkurse empfehlen wir eine frÃ¼hzeitige Anfrage, da diese schnell ausgebucht sind. Unsere Ponys sind eben sehr begehrt!',
  },
  {
    q: 'Was kostet der SpaÃŸ mit den Ponys?',
    a: 'Das hÃ¤ngt vom Angebot ab â€“ eine kurze Ponyrunde kostet natÃ¼rlich weniger als ein ganzer Geburtstag mit Schatzsuche und Stallolympiade. Wir versuchen, faire Preise anzubieten, die unsere Kosten decken (Ponys sind nÃ¤mlich richtige kleine Fressmaschinen). <NuxtLink to="/contact" class="text-primary-color hover:underline font-semibold">Fragt uns einfach</NuxtLink> nach den aktuellen Preisen fÃ¼r euer Wunschangebot, dann nennen wir euch die genauen Zahlen.',
  },
  {
    q: 'Ãœbernimmt die Krankenkasse die Kosten fÃ¼r Reittherapie?',
    a: 'In den meisten FÃ¤llen leider nein â€“ die gesetzlichen Kassen sind da etwas knauserig. Unter bestimmten UmstÃ¤nden gibt es aber MÃ¶glichkeiten fÃ¼r ZuschÃ¼sse, z.B. Ã¼ber die Eingliederungshilfe oder bei bestimmten Indikationen. Sprecht uns an, wir kennen einige Wege und Tipps, wie man UnterstÃ¼tzung beantragen kann. Und wir stellen natÃ¼rlich gerne entsprechende Bescheinigungen aus.',
  },
  {
    q: 'Wie kann ich meine Daten lÃ¶schen lassen?',
    a: 'Kein Problem! Schickt uns einfach eine Nachricht mit eurem LÃ¶schungswunsch â€“ wir kÃ¼mmern uns prompt darum und entfernen eure Daten schneller als Pony Napoleon einen ungesicherten Futtersack leert. Versprochen!',
  },
  {
    q: 'Kann ich Gutscheine fÃ¼r eure Angebote bekommen?',
    a: 'Aber natÃ¼rlich! Gutscheine sind super Geschenke â€“ viel besser als der dritte Schlafanzug oder das fÃ¼nfte Spielzeug, das nach zwei Tagen in der Ecke liegt. Wir stellen schÃ¶ne Wert- oder Erlebnisgutscheine aus â€“ ob fÃ¼r eine Reitstunde, einen ganzen Kurs oder einen bestimmten Geldbetrag. Perfekt fÃ¼r Geburtstage, Weihnachten oder als Ãœberraschung zwischendurch. Die Freude ist garantiert grÃ¶ÃŸer als bei Socken!',
  },
  {
    q: 'Wie lange dauert eine Reittherapie-Einheit?',
    a: 'Eine Einheit dauert 45 Minuten â€“ davon sind etwa 30 Minuten aktive Zeit mit dem Pony. Die restliche Zeit nutzen wir fÃ¼r Vor- und Nachbereitung. Je nach individuellem Bedarf kÃ¶nnen wir auch lÃ¤ngere Einheiten vereinbaren. Die Erfahrung zeigt: Mehr als 30 Minuten am StÃ¼ck auf dem Pony wird fÃ¼r die meisten Kinder anstrengend â€“ Reiten aktiviert nÃ¤mlich viel mehr Muskeln, als man denkt! Glaubt uns, auch Erwachsene bekommen nach einer Reiteinheit Muskelkater an Stellen, von denen sie nicht mal wussten, dass dort Muskeln sind.',
  },
  {
    q: "Gibt's eine MÃ¶glichkeit zum Schnuppern, bevor wir uns festlegen?",
    a: 'Klar! Wir bieten regelmÃ¤ÃŸig Schnupperstunden oder Schnuppertage an. So kÃ¶nnt ihr und euer Kind erstmal austesten, ob die Chemie mit unseren Vierbeinern und uns stimmt. Es ist uns wichtig, dass sich alle wohlfÃ¼hlen â€“ inklusive unserer Ponys. Die haben nÃ¤mlich auch mal einen schlechten Tag und keine Lust auf Fremde (genau wie wir Menschen manchmal), und das respektieren wir.',
  },
  {
    q: 'Bietet ihr Praktikums- oder FSJ-PlÃ¤tze an?',
    a: 'Ja! FÃ¼r alle, die Stallluft statt BÃ¼roduft schnuppern wollen: Wir vergeben begrenzt PraktikumsplÃ¤tze und FSJ-Stellen. Allerdings solltet ihr wissen, dass der Job nicht nur aus Ponyschmusen besteht â€“ Stallarbeit bedeutet auch Mistschaufeln, Fegen, und das bei jedem Wetter. Aber dafÃ¼r bekommt ihr echte Einblicke in pferdegestÃ¼tzte Arbeit und jede Menge Ponyliebe zurÃ¼ck. Bewerbt euch mit einem kurzen Motivationsschreiben und erzÃ¤hlt uns, warum ihr Ponyfans seid.',
  },
  {
    q: 'Wie stellt ihr die Sicherheit sicher?',
    a: 'Sicherheit steht bei uns an erster Stelle! Unsere Ponys sind gut ausgebildet und Kinderprofis. Wer bockt oder beiÃŸt, kommt nicht in unser Team (gilt fÃ¼r Ponys UND Menschen!). Die Kinder tragen immer Helme, wir passen die GruppengrÃ¶ÃŸe an, und es ist immer eine fachkundige Person dabei. Wir Ã¼berlegen vor jeder AktivitÃ¤t: Ist das sicher? Kann etwas passieren? Und trotzdem: Pferde sind Lebewesen und keine Maschinen â€“ deshalb bleiben wir immer aufmerksam. Das Gute ist: Unsere Shettys sind so nah am Boden, dass selbst ein Sturz meist glimpflich ausgeht!',
  },
  {
    q: 'Kann ich mir den Ponyhof vorher mal anschauen?',
    a: 'Unbedingt! Wir zeigen euch gerne unseren kleinen Ponyhof â€“ nach Terminabsprache natÃ¼rlich, damit wir Zeit fÃ¼r euch haben und nicht gerade mitten im Mistausmisten stecken. Die HoffÃ¼hrung ist kostenlos und unverbindlich. Ihr lernt die Ponys kennen, seht die Umgebung und kÃ¶nnt all eure Fragen loswerden. Ãœbrigens: Die Ponys freuen sich immer Ã¼ber Besucher, besonders wenn diese MÃ¶hrchen mitbringen (aber bitte vorher fragen, bevor ihr fÃ¼ttert!).',
  },
  {
    q: 'Wie kann ich bezahlen?',
    a: "Wir sind flexibel: Bar, EC-Karte oder Ãœberweisung â€“ alles kein Problem. Bei Kursen und grÃ¶ÃŸeren Events bitten wir um Vorauskasse per Ãœberweisung, damit wir planen kÃ¶nnen. Eine ordentliche Rechnung gibt's natÃ¼rlich dazu. Wir akzeptieren leider keine Bezahlung in PferdeÃ¤pfeln, obwohl die bei uns reichlich vorhanden sind... ğŸ˜‰",
  },
  {
    q: "Gibt's ParkplÃ¤tze bei euch?",
    a: 'Ja, direkt vor dem Hof gibt\'s genug kostenfreie ParkplÃ¤tze. Ihr erkennt sie an dem Schild "Hier parken nur Pferdenarren" (SpaÃŸ beiseite, folgt einfach der Beschilderung). Bitte nicht auf dem Reitplatz oder vor den Boxen parken â€“ da kÃ¶nnten die Ponys denken, ihr seid ein neues, fahrbarees Futterlager.',
  },
  {
    q: 'Was passiert, wenn mein Kind krank wird?',
    a: 'Das Leben passiert, und ErkÃ¤ltungen kennen keine TerminplÃ¤ne! Bitte gebt uns einfach so frÃ¼h wie mÃ¶glich Bescheid. Wir versuchen immer, einen Ersatztermin zu finden oder erstatten anteilig die Kosten laut unseren Bedingungen. Wichtig: Bitte schickt keine kranken Kinder zu uns â€“ auch wenn sie unbedingt kommen wollen. Das ist weder fÃ¼r euer Kind noch fÃ¼r die anderen Teilnehmer schÃ¶n. Die Ponys laufen nicht weg und freuen sich auf den Besuch, wenn alle wieder gesund sind!',
  },
  {
    q: 'MÃ¼ssen Kinder bei euch im Stall mithelfen?',
    a: 'Ja, und das ist ein wichtiger Teil des Erlebnisses! Wir glauben fest daran, dass zum Reiten auch das Rundumpaket gehÃ¶rt: Putzen, Hufe auskratzen, ein bisschen Stallarbeit. Keine Sorge, alles altersgerecht und mit Anleitung! Die meisten Kinder LIEBEN es, "richtige" Aufgaben zu bekommen und zu sehen, was zum Pferdeleben dazugehÃ¶rt. AuÃŸerdem lernen sie dabei Verantwortung und dass ein Pony kein Spielzeug ist, das man einfach in die Ecke stellt, wenn man fertig ist.',
  },
  {
    q: 'Haben eure Ponys eigentlich auch mal frei?',
    a: 'Aber hallo! Unsere Vierbeiner haben tÃ¤glich Weidegang (sofern das Wetter mitspielt) und regelmÃ¤ÃŸig komplett freie Tage. Jedes Pony arbeitet maximal 2-3 Stunden am Tag und hat zwischen den Einheiten Pausen. Ganz wichtig: Wir achten sehr genau auf die Stimmung unserer Tiere. Wenn ein Pony mal keinen Bock hat (ja, das kommt vor!), respektieren wir das und zwingen es zu nichts. Ein genervtes Pony ist weder fÃ¼rs Kind noch fÃ¼r uns angenehm. Ãœbrigens: Pucki macht jeden Freitagnachmittag "MÃ¤hnepflege" und ist dann fÃ¼r nichts zu haben â€“ SchÃ¶nheit braucht eben Zeit!',
  },
];

const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [],
};

baseFaqs.forEach(({ q, a }) => {
  const plainTextAnswer = a
    .replace(/<NuxtLink.*?>(.*?)<\/NuxtLink>/g, '$1')
    .replace(/<[^>]*>/g, '');
  faqSchema.mainEntity.push({
    '@type': 'Question',
    name: q,
    acceptedAnswer: { '@type': 'Answer', text: plainTextAnswer },
  });
});

// SEO Meta-Daten mit useMySeoMeta
useMySeoMeta({
  title: `FAQ Ponyreiten ${businessAddress.city} - HÃ¤ufige Fragen`,
  description: `Antworten auf hÃ¤ufig gestellte Fragen zu Ponyreiten, Reittherapie, Kindergeburtstagen und unserem Ponyhof in ${businessAddress.city}.`,
  keywords: [
    `FAQ Ponyreiten ${businessAddress.city}`,
    `Fragen Kindergeburtstag Ponyhof ${businessAddress.city}`,
    `Infos Ferienkurs Pferde ${businessAddress.city}`,
    `Ponyhof ${businessAddress.city} Fragen`,
    `Reiten Kinder ${businessAddress.city} FAQ`,
    `Sarah Handte ${businessAddress.city}`,
  ],
  ogImage: `${siteUrl}/images/og-faq-ponyreiten-renningen.webp`, // Spezifisches OG Bild fÃ¼r FAQ erstellen!
  ogImageAlt: `FAQ Seite zum Ponyreiten und Pferdeangeboten in ${businessAddress.city}`,
  ldJson: faqSchema // Das FAQPage Schema direkt Ã¼bergeben
});

/*--------------------------------------------------
| FAQâ€‘EintrÃ¤ge fÃ¼r das Frontend
--------------------------------------------------*/
const faqItems = ref(
  baseFaqs.map((item) => ({
    question: item.q,
    answer: item.a,
    open: false,
  }))
);

const toggleItem = (index) => {
  faqItems.value[index].open = !faqItems.value[index].open;
};

const renderLinks = (htmlString) => {
  return htmlString.replace(
    /<NuxtLink to="([^"]*)" class="([^"]*)">(.*?)<\/NuxtLink>/g,
    '<a href="$1" class="$2">$3</a>'
  );
};

// Ãœbergangs-Hooks (bleiben unverÃ¤ndert)
const enter = (el, done) => { /* ... */ };
const afterEnter = (el) => { /* ... */ };
const leave = (el, done) => { /* ... */ };
</script>